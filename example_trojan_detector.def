Bootstrap: docker
From: pytorch/pytorch:latest

%setup
    mkdir ${SINGULARITY_ROOTFS}/svm_models

%files
    ./example_trojan_detector.py /
    ./neuron.py /
    ./SCAn.py /
    ./utils.py /
    ./pytorch_ssim.py /
    ./model_factories.py /
    ./rf_clf.joblib /
    ./lr_clf.joblib /
    ./stack_clf.joblib /

%post
    /opt/conda/bin/conda install scikit-image jsonpickle
    pip install --upgrade trojai
    pip install lightgbm

%runscript
    exec python3 /example_trojan_detector.py "$@"
